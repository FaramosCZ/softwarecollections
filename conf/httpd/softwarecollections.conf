<VirtualHost *:443>

    ServerName www.softwarecollections.org
    ServerAdmin jdornak@redhat.com

    DocumentRoot            /var/scls/htdocs
    Alias           /static /var/scls/htdocs/static
    Alias           /media  /var/scls/htdocs/media
    Alias           /repos  /var/scls/htdocs/repos
    WSGIScriptAlias /       /var/scls/htdocs/wsgi.py
    ErrorDocument   400     /static/400.html
    ErrorDocument   403     /static/403.html
    ErrorDocument   404     /static/404.html
    ErrorDocument   500     /static/500.html

    WSGIDaemonProcess softwarecollections.org processes=2 threads=15 display-name=%{GROUP}
    WSGIProcessGroup softwarecollections.org

    <Directory /var/scls/htdocs>
        Order allow,deny
        Allow from all
        Require all granted
    </Directory>

    # Allow directory indexes for each scl root
    <Directory ~ /var/scls/htdocs/repos/[^/]+/[^/]+>
        Options +Indexes
    </Directory>

    ErrorLog    logs/softwarecollections_error_log
    TransferLog logs/softwarecollections_access_log
    LogLevel    warn

    # SSL Configuration
    SSLEngine on
    SSLProtocol all -SSLv2
    SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5
    SSLCertificateFile      /etc/pki/tls/certs/www_softwarecollections_org.crt
    SSLCertificateKeyFile   /etc/pki/tls/private/privkey.pem
    SSLCertificateChainFile /etc/pki/tls/certs/DigiCertCA.crt
    SSLCACertificateFile    /etc/pki/tls/certs/DigiCertCA.crt

    BrowserMatch "MSIE [2-5]" \
             nokeepalive ssl-unclean-shutdown \
             downgrade-1.0 force-response-1.0

</VirtualHost>

<VirtualHost *:80>
    ServerName  www.softwarecollections.org
    ServerAlias softwarecollections.org
    ServerAdmin jdornak@redhat.com
    Redirect  / https://www.softwarecollections.org/
</VirtualHost>

<VirtualHost *:443>
    ServerName  softwarecollections.org
    ServerAdmin jdornak@redhat.com
    Redirect  / https://www.softwarecollections.org/
    # SSL Configuration
    SSLEngine on
    SSLProtocol all -SSLv2
    SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5
    SSLCertificateFile      /etc/pki/tls/certs/www_softwarecollections_org.crt
    SSLCertificateKeyFile   /etc/pki/tls/private/privkey.pem
    SSLCertificateChainFile /etc/pki/tls/certs/DigiCertCA.crt
    SSLCACertificateFile    /etc/pki/tls/certs/DigiCertCA.crt

    BrowserMatch "MSIE [2-5]" \
             nokeepalive ssl-unclean-shutdown \
             downgrade-1.0 force-response-1.0
</VirtualHost>

