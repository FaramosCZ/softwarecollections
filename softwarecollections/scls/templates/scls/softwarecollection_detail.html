{% extends "with_submenu.html" %}
{% load auth %}
{% load md2 %}
{% load rating_stars %}
{% load url from future %}

{% block submenu %}{% include "scls/submenu.html" %}{% endblock %}

{% block title %}{{ scl.title }}{% endblock %}

{% block content %}
<h1>{{ scl.title }}</h1>
<p>
    added by
    <a href="{% url "scls:list_user" scl.maintainer.username %}">
        {% if scl.maintainer.get_full_name %}{{ scl.maintainer.get_full_name }}{% else %}{{ scl.maintainer.username }}{% endif %}
    </a>
</p>
{{ scl.description | markdown2 }}

<h2>Instructions</h2>
{{ scl.instructions | markdown2 }}

<h2>Policy</h2>
{{ scl.policy | markdown2 }}

<p class="scl-tags">
    {% for tag in scl.tags %}
        <a href="{% url "scls:list_tag" tag.name %}" class="scl-tag scl-tag-{{ tag.name }}">{{ tag.name }}</a>
    {% endfor %}
</p>

<h2>Yum Repositories</h2>
<ul>
{% for repo in scl.get_enabled_repos %}
    <li>
        {% if repo.last_sync_date %}
            <a href="{{ repo.get_absolute_url }}">{{ repo.name }}</a>
        {% else %}
            {{ repo.name }} (not synced)
        {% endif %}
    </li>
{% endfor %}
</ul>

{% allowed 'edit' obj=scl %}
<p><a href="{{ scl.get_edit_url }}">edit</a></p>
{% notallowed %}
{# user is not allowed to edit this collection #}
{% endallowed %}

{% if scl.score_count %}
<strong>Users' rating of this collection:</strong>
{% rating_stars 'passive' scl %}
<p>Rated by {{ scl.score_count }} user{{ scl.score_count|pluralize }}</p>
{% endif %}

{% allowed 'rate' obj=scl %}
{% if user_score %}
<strong>Your rating:</strong>
{% else %}
<strong>Rate this collection:</strong>
{% endif %}
{% rating_stars 'active' scl user_score %}
{% endallowed %}

{% endblock %}
